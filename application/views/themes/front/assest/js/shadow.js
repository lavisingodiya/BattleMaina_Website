var c=document.getElementById("canvas_shadow"),ctx=c.getContext("2d");function resize(){var t=c.getBoundingClientRect();c.width=t.width,c.height=t.height}var light={x:160,y:200},colors=["#f5c156","#e6616b","#5cd3ad"];function drawLight(){ctx.beginPath(),ctx.arc(light.x,light.y,1e3,0,2*Math.PI);var t=ctx.createRadialGradient(light.x,light.y,0,light.x,light.y,1e3);t.addColorStop(0,"#3b4654"),t.addColorStop(1,"#2c343f"),ctx.fillStyle=t,ctx.fill(),ctx.beginPath(),ctx.arc(light.x,light.y,20,0,2*Math.PI),(t=ctx.createRadialGradient(light.x,light.y,0,light.x,light.y,5)).addColorStop(0,"#fff"),t.addColorStop(1,"#3b4654"),ctx.fillStyle=t,ctx.fill()}function Box(){this.half_size=Math.floor(50*Math.random()+1),this.x=Math.floor(Math.random()*c.width+1),this.y=Math.floor(Math.random()*c.height+1),this.r=Math.random()*Math.PI,this.shadow_length=2e3,this.color=colors[Math.floor(Math.random()*colors.length)],this.getDots=function(){var t=2*Math.PI/4;return{p1:{x:this.x+this.half_size*Math.sin(this.r),y:this.y+this.half_size*Math.cos(this.r)},p2:{x:this.x+this.half_size*Math.sin(this.r+t),y:this.y+this.half_size*Math.cos(this.r+t)},p3:{x:this.x+this.half_size*Math.sin(this.r+2*t),y:this.y+this.half_size*Math.cos(this.r+2*t)},p4:{x:this.x+this.half_size*Math.sin(this.r+3*t),y:this.y+this.half_size*Math.cos(this.r+3*t)}}},this.rotate=function(){var t=(60-this.half_size)/20;this.r+=.002*t,this.x+=t,this.y+=t},this.draw=function(){var t=this.getDots();ctx.beginPath(),ctx.moveTo(t.p1.x,t.p1.y),ctx.lineTo(t.p2.x,t.p2.y),ctx.lineTo(t.p3.x,t.p3.y),ctx.lineTo(t.p4.x,t.p4.y),ctx.fillStyle=this.color,ctx.fill(),this.y-this.half_size>c.height&&(this.y-=c.height+100),this.x-this.half_size>c.width&&(this.x-=c.width+100)},this.drawShadow=function(){var t=this.getDots(),h=[],i=[];for(dot in t){var s=Math.atan2(light.y-t[dot].y,light.x-t[dot].x),e=t[dot].x+this.shadow_length*Math.sin(-s-Math.PI/2),o=t[dot].y+this.shadow_length*Math.cos(-s-Math.PI/2);h.push(s),i.push({endX:e,endY:o,startX:t[dot].x,startY:t[dot].y})}for(var a=i.length-1;a>=0;a--){var l=3==a?0:a+1;ctx.beginPath(),ctx.moveTo(i[a].startX,i[a].startY),ctx.lineTo(i[l].startX,i[l].startY),ctx.lineTo(i[l].endX,i[l].endY),ctx.lineTo(i[a].endX,i[a].endY),ctx.fillStyle="#2c343f",ctx.fill()}}}var boxes=[];function draw(){ctx.clearRect(0,0,c.width,c.height),drawLight();for(var t=0;t<boxes.length;t++)boxes[t].rotate(),boxes[t].drawShadow();for(t=0;t<boxes.length;t++)collisionDetection(t),boxes[t].draw();requestAnimationFrame(draw)}for(resize(),draw();boxes.length<14;)boxes.push(new Box);function collisionDetection(t){for(var h=boxes.length-1;h>=0;h--)if(h!=t){var i=boxes[t].x+boxes[t].half_size-(boxes[h].x+boxes[h].half_size),s=boxes[t].y+boxes[t].half_size-(boxes[h].y+boxes[h].half_size);Math.sqrt(i*i+s*s)<boxes[t].half_size+boxes[h].half_size&&(boxes[t].half_size=boxes[t].half_size>1?boxes[t].half_size-=1:1,boxes[h].half_size=boxes[h].half_size>1?boxes[h].half_size-=1:1)}}window.onresize=resize,c.onmousemove=function(t){light.x=null==t.offsetX?t.layerX:t.offsetX,light.y=null==t.offsetY?t.layerY:t.offsetY};